# 🔴 토비의 클린 스프링 - 도메인 모델 패턴과 헥사고날 아키텍처 Part 1

## 🟠 강의 소개

### 🟢 진행 내용

스프런(Splearn)이라는 가상의 스타트업 개발팀이 되어 토비님과 함께 프로젝트를 진행해보는 경험을 해볼 수 있다.

### 🟢 강의 듣기 전 알면 좋은 내용

토비님이 발표하신 [인프콘 2024 클린 스프링](https://www.youtube.com/watch?v=d3krJ4el8Hg) 영상을 먼저 시청하자

그리고 강의 제목이 왜 클린 스프링일까? 왜 클린 스프링을 해봐야할까? 에 대해 알아보고 시작하자

(영상 길이는 약 40분이다.)

그리고 만약 강의를 결제했거나 하지 않았더라도 토비님께 직접 질문하고 영상을 찾아볼 수 있다.

`유튜브 기술 채널` www.youtube.com/㖅tobyspring㏘

`디스코드 서버` https://discord.gg/x4eT5HYk6X㏘

`이메일` tobyilee@gmail.com

디스코드 서버에서는 직접 토비님이 운영하고 계시니 궁금한 점이 있다면 들어가서 소통해볼 수 있는 기회도 가져보자!


### 🟢 클린 코드랑 다른가?

로버트 마틴이 제안한 Clean Code라는 책을 한번 들어보거나 직접 읽어봤을 것이다.

이 책에 나오는 클린 코드에 대한 내용들을 보면 정말 개발자로써 잘 따라야 하고 유지보수성에 있어 굉장히 뛰어나질 것이라 생각이 든다.

나도 이 책을 너무 재밌게 읽고 실제 실무에서 팀에게 내용을 제안 했을 때 팀장님에게 이런 말을 들었다

```
우리 서비스랑은 맞지 않을거 같아. 우리는 더 빠르게 서비스를 제공하는게 목표고 사용자들은 더 많으 기능을 빠르게 이용하는 경험을 원해
너가 하고 싶은게 뭔지 알고 좋지만 우리에겐 리소스가 부족해
```

또한 모든 팀원들이 클린 코드를 잘 알고 하고 싶은 것은 아니다. 생각보다 팀원들은 이미 현재 일에 많이 지쳐있고 개발보다 더 중요한 것이 있을 수도 있다.

![img.png](image/img.png)

또한 실제로 이동욱(향로, 조졸두, 기억보단 기록은, 인프런 아버지 등)님의 말에 공감을 많이 했다.

```
개인 경험입니다.

회사 프로젝트의 1개의 기능을 만들기 위해 테스트를 하루 종일 짰고 이런 기능이 실제 서비스에 반영되었을 때 내가 예상하지 못한 버그가 발생하여 문제가 발생한 적이 있다 ㅋㅋㅋㅋ
그리고 문제는 그 기능을 수정할때 내가 만들어둔 아주 타이트한 테스트 때문에 수정을 조금만 해도 테스트에서 다 걸려서 빌드가 안되는 것이였다.
결국 빠르게 기능을 수정하기 위해 테스트를 다 Ignore 처리한 후 수정을 빠르게 해서 배포했고 이후에 리팩토링을 다시 진행한 경험이 있다.
```

이렇듯 잘못된 개념에 매몰되어 실제 구현 능력을 뒤로 미루고 중요한 것을 놓치고 있는 것이 아닐까?

실제로 나는 위에 경험을 통해 이후에는 테스트 코드를 아주 타이트하게 짜지 않는 방법에 대해 고민하게 되었고

테스트를 짤때 각 계층 별로 책임만을 테스트하도록 테스트 코드를 개선해서 작성하고 있다.

그리고 또 한가지 너무 좋은 구성을 고민하게 되는 것이다. 개인 프로젝트만 해도 로그인부터 만든다고 했을 때 어떻게 만들까?에 대해 고민해보자

1. session을 통한 로그인 처리
2. spring security를 통한 session 로그인 처리
3. jwt/ouath를 이용하여 db에 token을 저장하는 구조
4. jwt/ouath 이용하여 redis에 token을 저장하는 구조
5. msa 방식으로 gateway를 두고 로그인 서버만을 따로 구성하여 로그인 담당 서비스를 만드는 구조

이 중 가장 적절한 구조는 어떤것일까? 가장 적절하다는 말은 각자의 환경과 서비스 규모에 따라 다 다를것이다.

하지만 개발자들이 가장 많이 하는 실수는 이게 좋대! 이게 요즘 유행이던데? xxx이라는 유명한 개발자는 이렇게 만든다고 하던데? 라며 하는 선택일 것이다.

물론 요즘 가장 유명하고 좋은 개발자분이 사용하는 방법은 당연히 좋은 방법일 것이다. 하지만 그것이 우리 서비스에서 오버 팩토링이 아닌지 꼭 생각해 봐야할 것이고

내가 잘 할수 있는 구조인가? 우리 팀이 할 수 있는 부분인가?에 대해 고민해볼 부분이라 생각이 든다!

클린코드만을 지키기 위해 팀의 생산성과 팀의 문화를 해치는 것은 마치 다들 집에서 잘 살고 있는데 결벽증 환자가 모든 것이 잘못되었다고 하는 것과 비슷하다고 생각한다.

이런 부분에 있어 토비님의 클린 스프링도 이렇듯 클린 코드를 무조건 따르는 것이 아닌 Clean Code that works라는 의미로 깔끔하게 작동하는 코드를 지향하고자 한다.

### 🟢 토비의 클린 스프링은?

1. 읽기 좋은 코드
2. 이해하기 좋은 코드
3. 확장하기 좋은 코드
4. 유지보수하기 좋은 코드

이것들을 목표로 하며 위에서 클린코드를 지향할 때의 문제점을 보완하여 생산성과 유지보수성 그리고 코드의 품질을 적절히 조절하며 진행한다.

### 🟢 기술의 부채

회사에서 가장 고민되는 부분이고 개발자들이 항상 고민해야되는 말이다.

빠르게 서비스를 하는 것이 목표이니 기술의 부채는 어쩔 수 없지...!

기술의 부채라는 것은 어디까지 허용되는 단어일까? 모든 데이터를 map에 때려 넣어도 될까? 모든 분기 처리는 if와 else면 처리할 수 있는 것일까? 우리 회사 프로젝트는 모놀리스 방식이라 기술의 부채를 안고 있는 걸까?

이러한 부분들에 대해서 개발자로써 고민을 해봐야할 것 같다.

토비님은 이 부분에 대해서 고민을 해결할 수 있는 방법으로는 `테스트`라고 하셨다. 테스트 코드를 잘 작성해두면 리팩토링을 진행할 때 많은 도움이 되기 때문이다.

개발을 시작할땐

1. 익숙한 기술로
2. 핵심 기능이 잘 작동하도록
3. 가장 단순한 코드를 리팩토링하기 좋도록 작성

이 규칙을 통해 테스트를 작성하고 이후에 리팩토링 하는 것을 기술부채를 줄여가는 과정이라 생각한다고 한다.

### 🟢 팀

위에서 언급하지 않았던 부분이였는데. 개발자로써 유지보수성, 생산성, 코드품질 이외에도 가장 중요한 요소가 있다. 그것은 바로 팀워크다.

아무리 나 혼자 3가지를 고려하고 있다고 해도 팀원들과 함께할 수 없다면 진행할 수 없다. 다들 테스트 안짜는데 나혼자 테스트를 붙이고 있다고 가정하자

나중에 누군가 해당 소스를 수정하고 빌드를 하고 터져버린다. 그리고 모든 팀원은 테스트 코드를 작성할 줄 모른다. 이러면 해당 문제는 내가 해결해야만 하는 문제가 되고

팀의 생산성과 유지보수성을 모두 해친 사람은 테스트 코드를 열심히 작성한 내가 된다.

근본적으로 클린 코드는 팀워크를 위해 제안된 부분이다. 다른 개발자가 내 코드를 좀 더 쉽게 읽으라고 내 코드를 좀 더 쉽게 안전하게 수정하라고 하는 것이지

나의 만족만을 위해 작성하는 클린 코드는 클린 코드가 아닐 수 있다는 것이다.

그렇기에 팀원들에게 교양있는 개발자가 되어보자. 함께 코드를 작성하고 분석하고 수정할 동료들에게 읽기 편한 친절한 코드를 작성해보자.






